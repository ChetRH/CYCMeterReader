CYC METER READER — PROJECT REFERENCE
=====================================

RESUME WITH CLAUDE
------------------
Start a new Claude session and say:
"Resume my CYC Meter Reader project — it's at https://github.com/ChetRH/CYCMeterReader"


PROJECT LINKS
-------------
GitHub Repository : https://github.com/ChetRH/CYCMeterReader
Live App          : https://chetRH.github.io/CYCMeterReader/


SHAREPOINT / MICROSOFT
-----------------------
SharePoint Site   : capitalyachtclubcom.sharepoint.com/sites/DockOperations
Meter Reading File: CYC Dock Meter Reading.xlsx
Electricity Report: Electricity Report.xlsx
Archive Folder    : Meter Archive  (subfolder, auto-created)
Azure Client ID   : 7df5213e-e0a0-4fff-ad01-69e83d7cb6f5


ELECTRICITY REPORT LAYOUT
--------------------------
Col B  : Slip ID (A01, B03, etc.)
Col H  : Most recent month's meter readings (new column inserted each cycle)
Col H1 : Column header format — DD-MMMYYexample: 20-Feb26
C116   : Rate per kWH label + date  (e.g. "Rate per kWH 2/20/2026")
D116   : PEPCO KWH rate value       (e.g. 0.1809)


APP WORKFLOW
------------
1. START NEW BILL READINGS
   - Archives current meter file to "Meter Archive" folder with date/time stamp
   - Clears the main sheet
   - Loads col H from Electricity Report as Previous Readings baseline

2. METER READING (Dock walkers)
   - Navigate by dock (A / B / C) and slip arrows
   - Enter 6-digit reading via keyboard, voice mic, or calculator-style input
   - Previous reading is locked from baseline — does not change during cycle
   - Current reading persists in field until new cycle starts
   - Save & Next advances to next slip in walk order

3. SAVE TO ONEDRIVE EXCEL
   - Writes all readings to CYC Dock Meter Reading.xlsx on SharePoint

4. OFFICE USE ONLY — ENTER PEPCO KWH RATE
   - Prompts for rate (e.g. 0.1809)
   - Inserts a new column H in Electricity Report with today's date as header
   - Writes each slip's current reading into that column
   - Saves rate and date to C116 / D116


DOCK WALK ORDER
---------------
A Dock : A01→A35 (odd, out), A30→A02 (even, back)
B Dock : B01→B29 (odd, out), B28→B04 (even, back)  [no B02]
C Dock : C03→C27 (odd, out), C36→C02 (even, back)  [no C01]


METER READING RULES
--------------------
- Capture 6 digits from meter
- Discard the last digit before saving (stored as 5 digits)
- Display uses leading zeros + trailing 0 to show 6 digits
  Example: stored 4510 displays as 045100


CURRENT VERSION
---------------
Ver 1.4.6 — 2/23/2026

CHANGES IN 1.4.6
----------------
- Resume / Reread now loads the baseline (Previous Readings) from
  Electricity Report col H — same locked source as Start New Month
- Resume also loads current-cycle readings from CYC Dock Meter Reading.xlsx
  into localStorage so the user can continue where they left off
- syncToOneDrive no longer overwrites the baseline — previous readings
  are now locked for the entire billing cycle and only refresh on
  Start New Month or Resume

CHANGES IN 1.4.5
----------------
- Fixed initials input not accepting keyboard input on mobile
  Root cause: input event handler was mutating this.value mid-event,
  which breaks Android/iOS IME input (swallowed chars, dismissed keyboard)
- Added autocomplete/autocorrect/autocapitalize/spellcheck attributes
  so mobile keyboards work correctly and show caps layout by default
- CSS text-transform:uppercase now handles display; saveInitials() uppercases on store

CHANGES IN 1.4.4
----------------
- Initials field on home screen: user enters their initials (up to 4 chars, auto-uppercase)
  saved to localStorage and attached to every reading entry
- Spreadsheet gains a "Reader" column H with the initials of who recorded each reading
- All sheet ranges updated from A:G to A:H throughout (sync, reset, load baseline)

CHANGES IN 1.4.3
----------------
- Low-reading comparison now uses full 6-digit display values (trailing zero on both sides)
  instead of stripping the trailing zero before comparing, ensuring scale always matches

CHANGES IN 1.4.2
----------------
- Skip slips with no data entered: Save & Next and arrow navigation now advance
  silently when no reading has been typed (000000), instead of blocking with an error
- Validation rules (low reading warning, etc.) still apply when data has been entered

CHANGES IN 1.4.1
----------------
- IT Chair only checkbox (checked by default) — uncheck to email all office staff
- Email now HTML with CYC Burgee, spreadsheet link (resolved via Graph API), and app link
- Spreadsheet link opens directly in Excel Online via SharePoint webUrl

CHANGES IN 1.4
--------------
- Send to Office: now emails notification to office staff (no longer manually syncs)
- Auto-sync: readings automatically sync to SharePoint Excel every 5 minutes while signed in
  (supports multiple devices reading simultaneously)
- Email recipients: gm, office, ITChair, Assistant, DM @capitalyachtclub.com
- Mail.Send permission added to Microsoft login scope
